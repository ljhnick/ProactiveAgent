<!DOCTYPE html>
<html>

<head>
  <style>
    body,
    html {
      height: 100%;
      margin: 0;
      overflow: hidden;
    }

    .container {
      height: 100%;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .video-container {
      position: relative;
      width: 100%;
      flex: 1;
    }

    .video-feed {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .reminder {
      width: 20%;
      background: rgba(119, 192, 225, 0.6);
      position: absolute;
      top: 10px;
      left: 10px;
      border-radius: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      border: 3px dotted white;
    }

    .reminder-content {
      text-align: center;
      padding: 20px;
    }

    .reminder-label {
      color: black;
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .vertical-menu {
      width: 40%;
      background: rgba(247, 247, 253, 0.6);
      position: absolute;
      top: 10px;
      right: 10px;
      border-radius: 5px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .horizontal-menu {
      width: 20%;
      background: rgba(0, 0, 0, 0.75);
      position: absolute;
      bottom: 10px;
      left: 10px;
      border-radius: 5px;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .iframe-container {
      display: flex;
      justify-content: center;
      align-items: center;
      position: absolute;
      bottom: 10px;
      left: 30%;
      width: 40%;
      height: 10%;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      background-color: white;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="video-container">
      <img src="{{ url_for('video_feed') }}" class="video-feed">
    </div>
    <div class="reminder">
      <div class="reminder-content">
        <label for="reminder" class="reminder-label">Reminder</label>
        <p id="reminder-text" class="reminder-text"></p>
      </div>
    </div>

    <div class="vertical-menu">
      <div>
        <label for="location" style="color: black; font-size: 18px; font-weight: bold;">Current Location:</label>
        <p id="location-text" style="color: #04542E; font-size: 18px;"></p>
      </div>

      <div>
        <label for="activity" style="color: black; font-size: 18px; font-weight: bold;">Activity:</label>
        <p id="activity-text" style="color: #9A9409; font-size: 18px;"></p>
      </div>
    </div>

    <div class="horizontal-menu">
      <div>
        <label for="transcribeCheck" style="color: white; font-size: 18px; font-weight: bold;">Transcribe</label>
        <input type="checkbox" id="transcribeCheck" onclick="handleTranscribeToggle()">
      </div>

      <div>
        <label for="confidenceThreshold" style="color: white; font-size: 18px; font-weight: bold;">Confidence Threshold:</label>
        <input type="number" id="confidenceThreshold" min="0" max="100" step="1" onchange="handleConfidenceChange()">
      </div>
    </div>

    <div id="transSection" class="iframe-container">
     
    </div>

    <button id="startRecording" style="position: absolute; bottom: 80px; right: 20px; width: 20%;" type="button">
      Start Recording
    </button>
    <button id="stopRecording" style="position: absolute; bottom: 100px; right: 20px; width: 20%;" type="button">
      Stop Recording
    </button>  
    <script>
      const startRecButton = document.getElementById("startRecording");
      const stopRecButton = document.getElementById("stopRecording");
      const transSection = document.getElementById("transSection");
      startRecButton.disabled = false;
      stopRecButton.disabled = true;
      
      startRecButton.addEventListener('click', () => {
        const trans = document.getElementById("transcription") ?? document.createElement("iframe");
        trans.id = "transcription";
        trans.src = "{{ url_for('audio_feed', rec=1) }}";
        trans.title = "Transcription";
        transSection.appendChild(trans);
        startRecButton.disabled = true;
        stopRecButton.disabled = false;
      });

      stopRecButton.addEventListener('click', () => {
        const trans = document.getElementById("transcription");
        trans.src = "{{ url_for('audio_feed', rec=0) }}";
        startRecButton.disabled = false;
        stopRecButton.disabled = true;
      });
    </script>

    <div class="iframe-container">
      <iframe src="{{ url_for('audio_feed') }}" title="Transcription"></iframe>
    </div>
  </div>
</body>

</html>
